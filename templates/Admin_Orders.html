{% include 'navbar.html' %}
{% load custom_filters %}
<html xmlns="http://www.w3.org/1999/html">
<head>
    <title>Admin Orders</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #fffce8;
            color: #000;
            padding: 20px;
        }

        h1, h2, h3 {
            color: #222;
        }

        h1 {
            background-color: #ffcc00;
            padding: 15px;
            text-align: center;
            color: #000;
            border-radius: 10px;
        }

        .order-container {
            background-color: #ffffff;
            border: 2px solid #ffcc00;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 30px;
            box-shadow: 2px 2px 10px rgba(0,0,0,0.1);
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
        }

        th, td {
            border: 1px solid #ffcc00;
            padding: 10px;
            text-align: left;
        }

        th {
            background-color: #000;
            color: #fff;
        }

        tr:nth-child(even) {
            background-color: #fffbe6;
        }

        .label {
            font-weight: bold;
            color: #444;
        }
    </style>
</head>
<body>

    <h1>All Orders - Admin View</h1>

    {% for order in orders %}
    <div class="order-container">
        <h2>Order ID: {{ order.id }}</h2>
        <p><span class="label">Name:</span> {{ order.Fullname }}</p>
        <p><span class="label">Phone:</span> {{ order.Phonenumber }}</p>
        <p><span class="label">Address:</span> {{ order.Address }}</p>
        <p><span class="label">Payment Method:</span> {{ order.Paymentmethod }}</p>
        <p><span class="label">Total Price:</span> â‚¹{{ order.Total_price }}</p>
        <p><span class="label">Order Status</span>: {{ order.Status }}</p>
   {% with delivery_mapping|get_item:order as partner %}
    {% if partner %}
        <p><span class="label">Delivery Partner:</span> {{ partner.Name }}</p>
        <p><span class="label">Contact:</span> {{ partner.Contact }}</p>


    {% else %}
        <p><span class="label">Delivery Partner:</span> Not Assigned</p>
        <a href="/out_for_delivery_page/{{order.id}}"
   style="display: inline-block; background-color: orange; color: white; border: none;
          padding: 6px 12px; margin: 2px; text-decoration: none; text-align: center;">
    Out for Delivery
</a>
    {% endif %}
{% endwith %}

        <form action="{% url 'update_order_status' order.id %}" method="post">
    {% csrf_token %}



</form>
<form>
    <button onclick="printOrder(this)"
    style="background-color: green; color: white; border: none; padding: 6px 12px; margin: 2px;">
    Print Order
</button>

    <button type="submit" name="status" value="Cancelled"
        style="background-color: red; color: white; border: none; padding: 6px 12px; margin: 2px;">
        Cancel Order
    </button>
</form>



        <h3>Ordered Items</h3>
        <table>
            <thead>
                <tr>
                    <th>Product</th>
                    <th>Quantity</th>
                    <th>User ID</th>


                </tr>
            </thead>
            <tbody>
                {% for item in order_items %}
                    {% if item.order.id == order.id %}
                    <tr>
                        <td>{{ item.Product.Productname }}</td>
                        <td>{{ item.Quantity }}</td>
                        <td>{{ item.User_id }}</td>

                    </tr>
                    {% endif %}
                {% endfor %}
            </tbody>
        </table>
    </div>
    {% endfor %}
<script>
function printOrder(button) {
    
    var orderDiv = button.closest('.order-container');


    var printWindow = window.open('', '', 'height=600,width=800');
    printWindow.document.write('<html><head><title>Print Order</title>');
    printWindow.document.write('</head><body>');
    printWindow.document.write(orderDiv.innerHTML);
    printWindow.document.write('</body></html>');
    printWindow.document.close();
    printWindow.print();
}
</script>


</body>
</html>


